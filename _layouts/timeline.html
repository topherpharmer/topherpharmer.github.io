<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Timeline</title>
        <link rel="stylesheet" href="{{ "/assets/css/timeline_style.css " | prebend: site.baseurl }}">
        <link rel="stylesheet" href="/assets/css/card_list.css ">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

        <script>
            var postList = [
                {% for post in site.posts %}
                    {
                        tags: [
                            {% for tag in post.tags %}
                                "{{ tag }}"
                                {% unless forloop.last %},{% endunless %}
                            {% endfor %}],
                        url: "{{ post.url }}",
                        date: "{{ post.date | date_to_long_string }}",
                        type: "{{ post.type }}",
                        title: "{{ post.title }}",
                        subtitle: "{{ post.subtitle }}",
                        thumbnail: "{{ post.thumbnail }}",
                        excerpt:  "{{ post.content | strip_html | truncatewords: 50 }}"
                    }{% unless forloop.last %},{% endunless %}
                {% endfor %}
            ];

            function getCards(tag)
            {
                var temp = [];
                for (let i = 0; i < postList.length; i++)
                {
                    for (let j = 0; j < postList[i].tags.length; j++)
                        if (postList[i].tags[j] == tag)
                        {
                            temp.unshift(postList[i]);
                        }
                }
                return temp;
            }

            function updateList(tag)
            {
                var listElement = document.getElementById("list");

                listElement.innerHTML = "";

                var cardList = getCards(tag);

                for (let i = 0; i < cardList.length; i++)
                {
                    listElement.innerHTML +=
                        `<a href='${cardList[i].url}'><li class='card'>
                            <img src='${cardList[i].thumbnail}'>
                            <article class='content'>
                                <h2>${cardList[i].title}</h2>
                                <h3>${cardList[i].subtitle}</h3>
                                <p>${cardList[i].excerpt}</p>
                                <footer>${cardList[i].type} - ${cardList[i].date}</footer>
                            </article>
                        </li></a>`;
                }
                $(window).trigger('resize');
            }
        </script>
    </head>
    <body>
        <!--sidebar-->
        {% include sidebar.html %}

        <!--Navbar-->
        {% include navbar.html %}

        <!--Card List-->
        <div class="card_list" >
            <ul id="list"></ul>
        </div>
        <script>updateList("update");</script>
    </body>
</html>